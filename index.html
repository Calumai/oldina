<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026ä¸–ç•Œæ¯èªæ—¥ - makila kuman</title>
    
    <!-- è¼‰å…¥ Tailwind CSS (æ¨£å¼åº«) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- è¼‰å…¥ Babel (è®“ç€è¦½å™¨å¯ä»¥çœ‹æ‡‚ React JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* éŒ¯èª¤æ™‚çš„éœ‡å‹•å‹•ç•« */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .shake {
            animation: shake 0.3s ease-in-out;
        }

        /* éš±è—æ»¾å‹•æ¢ä½†ä¿æŒåŠŸèƒ½ */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="bg-stone-900 m-0 p-0 overflow-hidden">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'https://esm.sh/react@18.2.0';
        import ReactDOM from 'https://esm.sh/react-dom@18.2.0/client';
        import { 
          BookOpen, Edit3, Gift, UserCheck, ArrowRight, ArrowLeft,
          ThumbsUp, MapPin, Lock, Delete, LogIn, CreditCard, CheckCircle2, Check, RefreshCw, Map, ChevronLeft, ChevronRight
        } from 'https://esm.sh/lucide-react@0.263.1';

        // ==========================================
        // CONFIGURATION (è¨­å®šå€)
        // ==========================================
        // å¦‚æœæ‚¨ä¹‹å¾Œè¦ç”¨ Google Sheet ç•¶å¾Œå°ï¼Œè«‹æŠŠç¶²å€å¡«åœ¨é€™è£¡
        // å¦‚æœä¿æŒç©ºå­—ä¸²æˆ–ç¶²å€éŒ¯èª¤ï¼Œç³»çµ±æœƒè‡ªå‹•ä½¿ç”¨ä¸‹æ–¹çš„ demoPrizes é€²è¡Œæ¨¡æ“¬æŠ½ç
        const GAS_API_URL = "https://script.google.com/macros/s/AKfycbzCJVchaq7JMq1SJvNNNHzj1ojJDgmcffgoscCnrN5lx32_RvAzy1NSQT-VJWLush4/exec";

        // ==========================================
        // ZONE COMPONENTS
        // ==========================================

        // --- Zone A: åŸä½æ°‘æ–‡åŒ–çŸ¥è­˜é€š ---
        const TribeIntroZone = () => {
          const allTribes = [
            { title: "é˜¿ç¾æ— (Amis)", region: "æ±éƒ¨/èŠ±è“®å°æ±", subtitle: "è±å¹´ç¥­ (Ilisin)", content: "äººå£æœ€å¤šã€‚è±å¹´ç¥­åŒ…å«è»äº‹èˆ‡æ•™è‚²åŠŸèƒ½ï¼Œæ˜¯æ—äººå‘½è„ˆæ ¹æºã€‚", icon: "ğŸŒ¾", color: "bg-red-500" },
            { title: "æ’ç£æ— (Paiwan)", region: "å—éƒ¨/å±æ±å°æ±", subtitle: "æ”¶ç©«ç¥­ (Masalut)", content: "æœ‰åš´è¬¹éšç´šåˆ¶åº¦ã€‚å°ç±³æ”¶ç©«ç¥­ Masalut ä»£è¡¨ã€Œè·¨è¶Šã€æ–°å¹´ã€‚", icon: "ğŸ", color: "bg-slate-700" },
            { title: "æ³°é›…æ— (Atayal)", region: "åŒ—éƒ¨/ä¸­éƒ¨å±±å€", subtitle: "ç¥–éˆç¥­ (Maho)", content: "é‡è¦–ç¹”å¸ƒèˆ‡æ–‡é¢ã€‚ç¥–éˆç¥­é€éå‘¼å–šç¥–éˆç¥ˆæ±‚å¹³å®‰ã€‚", icon: "ğŸŒˆ", color: "bg-red-700" },
            { title: "å¸ƒè¾²æ— (Bunun)", region: "ä¸­å¤®å±±è„ˆ/å—æŠ•", subtitle: "å°„è€³ç¥­ (Malahodaigian)", content: "ç›¸ä¿¡ç²¾éˆ(Hanitu)ã€‚å°„è€³ç¥­è¨“ç·´å°å­©ç‹©çµï¼Œç²å¾—ç¤¾æœƒèªåŒã€‚", icon: "ğŸ¹", color: "bg-amber-600" },
            { title: "å‘å—æ— (Puyuma)", region: "æ±éƒ¨/å°æ±å¹³åŸ", subtitle: "å¹´ç¥­ (çŒ´ç¥­/å¤§çµç¥­)", content: "æœ‰åš´è¬¹çš„å¹´é½¡éšç´šèˆ‡æœƒæ‰€åˆ¶åº¦ã€‚å¹´ç¥­åŒ…å«çŒ´ç¥­èˆ‡å¤§çµç¥­ã€‚", icon: "ğŸ’", color: "bg-yellow-600" },
            { title: "é­¯å‡±æ— (Rukai)", region: "å—éƒ¨/å±æ±é«˜é›„", subtitle: "ç™¾åˆèŠ±èˆ‡ç›ªé¦éŸ†", content: "ä»¥ç™¾åˆèŠ±ç‚ºæ—èŠ±ã€‚å©šç¦®æ™‚æœƒèˆ‰è¡Œç›ªé¦éŸ†æ´»å‹•ï¼Œåˆ†äº«å–œæ‚…ã€‚", icon: "ğŸŒº", color: "bg-emerald-600" },
            { title: "é„’æ— (Tsou)", region: "ä¸­éƒ¨/å˜‰ç¾©é˜¿é‡Œå±±", subtitle: "æˆ°ç¥­ (Mayasvi)", content: "ç¥­æ‹œå¤©ç¥èˆ‡æˆ°ç¥ã€‚åœ¨åº«å·´(Kuba)ç”·å­æœƒæ‰€èˆ‰è¡Œï¼Œç¥ˆç¦±å‹åˆ©ã€‚", icon: "ğŸ”¥", color: "bg-red-600" },
            { title: "è³½å¤æ— (Saisiyat)", region: "åŒ—éƒ¨/æ–°ç«¹è‹—æ —", subtitle: "çŸ®éˆç¥­ (Pasta'ay)", content: "æ¯å…©å¹´èˆ‰è¾¦ä¸€æ¬¡ï¼Œç‚ºäº†ç´€å¿µä¸¦å®‰æ’«æ•™æœƒä»–å€‘è¾²è€•çš„çŸ®äººéˆé­‚ã€‚", icon: "ğŸŒ‘", color: "bg-indigo-700" },
            { title: "é”æ‚Ÿæ— (Tao)", region: "é›¢å³¶/è˜­å¶¼", subtitle: "é£›é­šç¥­", content: "å”¯ä¸€çš„æµ·æ´‹æ°‘æ—ã€‚éš¨é»‘æ½®èˆ‰è¡Œæ‹›é­šç¥­ï¼Œæœ‰åš´æ ¼çš„ç”Ÿæ…‹è¦ç¯„ã€‚", icon: "ğŸŸ", color: "bg-blue-500" },
            { title: "é‚µæ— (Thao)", region: "ä¸­éƒ¨/å—æŠ•æ—¥æœˆæ½­", subtitle: "ç¥–éˆç±ƒèˆ‡æµéŸ³", content: "ä¾›å¥‰ç¥–éˆç±ƒ(Ulalaluan)ã€‚æµéŸ³éŸ³æ¨‚èåï¼Œè¾²æ›†å…«æœˆéå¹´ã€‚", icon: "ğŸŒŠ", color: "bg-amber-700" },
            { title: "å™¶ç‘ªè˜­æ— (Kavalan)", region: "æ±éƒ¨/èŠ±è“®", subtitle: "æµ·ç¥­èˆ‡é¦™è•‰çµ²", content: "ä¿æœ‰ç¨ç‰¹é¦™è•‰çµ²ç·¨ç¹”ã€‚æ˜¥å¤é–“èˆ‰è¡Œæµ·ç¥­ï¼Œæ„Ÿè¬æµ·æ´‹è³œé£Ÿã€‚", icon: "ğŸŒ", color: "bg-yellow-700" },
            { title: "å¤ªé­¯é–£æ— (Truku)", region: "æ±éƒ¨/èŠ±è“®å±±å€", subtitle: "å½©è™¹æ©‹å‚³èªª", content: "é‡è¦–ç¹”å¸ƒèˆ‡æ–‡é¢ã€‚æ­»å¾Œè¦é€šéå½©è™¹æ©‹(Hakaw Utux)è¦‹ç¥–éˆã€‚", icon: "ğŸŒ‰", color: "bg-teal-600" },
            { title: "æ’’å¥‡èŠé›…æ— (Sakizaya)", region: "æ±éƒ¨/èŠ±è“®", subtitle: "ç«ç¥ç¥­ (Palamal)", content: "æ›¾éš±èº«é˜¿ç¾æ—ç™¾å¹´ã€‚ç«ç¥ç¥­ç´€å¿µç¥–å…ˆï¼ŒåŒ…å«ç¹å¢ƒå„€å¼ã€‚", icon: "ğŸ”¥", color: "bg-orange-700" },
            { title: "è³½å¾·å…‹æ— (Seediq)", region: "ä¸­éƒ¨/å—æŠ•èŠ±è“®", subtitle: "å´‡ä¿¡ Utux", content: "å¹³æ¬Šç¤¾æœƒã€‚ç¥­å„€é‡é»åœ¨ç¥ˆæ±‚æ—é‹èˆ‡ Utux (ç¥/ç¥–éˆ) çš„åº‡ä½‘ã€‚", icon: "âš”ï¸", color: "bg-red-800" },
            { title: "æ‹‰é˜¿é­¯å“‡æ— (Hla'alua)", region: "å—éƒ¨/é«˜é›„æ¡ƒæº", subtitle: "è–è²ç¥­ (Miatungusu)", content: "æ³¨é‡è¾²è€•ç¥­å„€ã€‚ç¥­ç¥€ 12 ä½è²ç¥ï¼Œæ˜¯ä¸»è¦çš„åœ–é¨°è±¡å¾µã€‚", icon: "ğŸš", color: "bg-cyan-600" },
            { title: "å¡é‚£å¡é‚£å¯Œæ— (Kanakanavu)", region: "å—éƒ¨/é«˜é›„é‚£ç‘ªå¤", subtitle: "ç±³è²¢ç¥­ (Mikong)", content: "é‡è¦ç¥­å„€æœ‰ç±³è²¢ç¥­èˆ‡æ²³ç¥­ã€‚å‚³çµ±ç‹©çµæ–¹å¼åŒ…å«å¸¶ç‹—èˆ‡é™·é˜±ã€‚", icon: "ğŸ•", color: "bg-lime-600" },
          ];

          const [cards, setCards] = useState([]);
          const [idx, setIdx] = useState(0);
          const [isFinished, setIsFinished] = useState(false);

          useEffect(() => {
            restart();
          }, []);

          const restart = () => {
            const shuffled = [...allTribes].sort(() => 0.5 - Math.random());
            setCards(shuffled.slice(0, 10));
            setIdx(0);
            setIsFinished(false);
          };

          const handleNext = () => {
            if (idx < cards.length - 1) {
              setIdx(prev => prev + 1);
            } else {
              setIsFinished(true);
            }
          };

          const handlePrev = () => {
            if (idx > 0) {
              setIdx(prev => prev - 1);
            }
          };

          if (cards.length === 0) return null;

          return (
            <div className="flex flex-col items-center justify-center min-h-full bg-stone-100 p-4">
              <div className="md:absolute md:top-4 md:left-4 mb-4 md:mb-0 bg-stone-800 text-white px-4 py-2 rounded-full font-bold flex items-center gap-2 z-10 shadow-lg">
                <BookOpen size={20} /> Zone Aï¼šåŸä½æ°‘æ–‡åŒ–çŸ¥è­˜é€š
              </div>

              {!isFinished ? (
                <div className="flex flex-col items-center justify-center w-full max-w-6xl flex-1 py-4 md:py-16">
                  
                  {/* å¤§ç‰ˆé¢è¨­è¨ˆ */}
                  <div className="w-full bg-white rounded-[2rem] shadow-2xl overflow-hidden flex flex-col md:flex-row border border-stone-200 animate-in zoom-in duration-300 md:min-h-[600px] h-auto">
                    
                    {/* å·¦å´ */}
                    <div className={`${cards[idx].color} w-full md:w-2/5 p-8 md:p-12 flex flex-col justify-center items-center text-white relative transition-colors duration-500 min-h-[300px] md:h-auto`}>
                       <div className="absolute top-0 left-0 w-full h-full overflow-hidden opacity-10 pointer-events-none">
                         <div className="absolute -top-10 -left-10 w-40 h-40 rounded-full bg-white"></div>
                         <div className="absolute bottom-10 right-10 w-20 h-20 rounded-full bg-white"></div>
                       </div>
                       
                       <div className="text-sm font-bold bg-black/20 px-3 py-1 rounded-full mb-4 flex items-center gap-2">
                          <MapPin size={14}/> {cards[idx].region}
                       </div>
                       
                       <h2 className="text-4xl md:text-5xl lg:text-6xl font-black mb-4 text-center leading-tight tracking-tight drop-shadow-sm">
                         {cards[idx].title}
                       </h2>
                       
                       <div className="mt-4 bg-white/20 backdrop-blur-md px-4 py-2 md:px-6 rounded-xl text-lg md:text-xl font-bold border border-white/40 shadow-lg text-center">
                          {cards[idx].subtitle}
                       </div>

                       <div className="absolute bottom-4 left-0 w-full text-center text-white/50 font-mono text-sm">
                         {idx + 1} / {cards.length}
                       </div>
                    </div>

                    {/* å³å´ */}
                    <div className="w-full md:w-3/5 p-6 md:p-16 flex flex-col justify-between bg-white relative">
                      <div className="mb-4 md:mb-auto">
                        <span className="text-stone-400 font-bold tracking-widest text-sm uppercase">CULTURE NOTE</span>
                        <h3 className="text-2xl md:text-3xl font-black text-stone-800 mt-2 mb-4 md:mb-6 border-l-8 border-stone-800 pl-4">
                          æ–‡åŒ–å°çŸ¥è­˜
                        </h3>
                        <p className="text-xl md:text-3xl text-stone-600 font-bold leading-relaxed text-justify">
                          {cards[idx].content}
                        </p>
                      </div>

                      <div className="mt-8 pt-8 border-t border-stone-100 flex flex-col md:flex-row gap-4">
                         <button 
                            onClick={handlePrev}
                            disabled={idx === 0}
                            className={`px-6 py-4 rounded-xl font-bold flex items-center justify-center gap-2 transition-all order-2 md:order-1 ${
                              idx === 0 
                                ? 'bg-stone-100 text-stone-300 cursor-not-allowed' 
                                : 'bg-stone-100 text-stone-600 hover:bg-stone-200'
                            }`}
                          >
                            <ArrowLeft size={24}/> <span className="md:hidden">ä¸Šä¸€å€‹</span>
                          </button>
                          
                          <button 
                            onClick={handleNext}
                            className="flex-1 px-8 py-4 bg-stone-800 text-white rounded-xl font-bold text-xl shadow-xl hover:bg-stone-700 active:scale-95 transition-all flex items-center justify-center gap-3 order-1 md:order-2"
                          >
                            {idx === cards.length - 1 ? "å®Œæˆå­¸ç¿’" : "æˆ‘çŸ¥é“äº†"} <ArrowRight size={24}/>
                          </button>
                      </div>
                    </div>
                  </div>

                </div>
              ) : (
                <div className="w-full max-w-lg text-center animate-in zoom-in py-20">
                  <div className="text-8xl mb-6">ğŸ“</div>
                  <h2 className="text-4xl font-black text-stone-800 mb-4">å­¸ç¿’å®Œæˆï¼</h2>
                  <p className="text-xl text-stone-600 mb-8 font-bold">ä½ å·²ç¶“çœ‹å®Œäº† 10 å€‹æ—ç¾¤çš„çŸ¥è­˜ã€‚<br/>æº–å‚™å¥½æ¥å—éš¨å ‚è€ƒäº†å—ï¼Ÿ</p>
                  <div className="flex flex-col md:flex-row gap-4 justify-center p-4">
                    <button onClick={restart} className="px-6 py-3 bg-white text-stone-500 rounded-xl font-bold shadow-md hover:bg-stone-50">
                      å†è¤‡ç¿’ä¸€æ¬¡
                    </button>
                    <div className="px-6 py-3 bg-amber-500 text-white rounded-xl font-bold shadow-md animate-bounce text-center">
                      è«‹å‰å¾€ Zone B è€ƒè©¦ï¼ğŸ‘‡
                    </div>
                  </div>
                </div>
              )}
            </div>
          );
        };

        // --- Zone B: å¡ç‰‡è§£å¯†æ¸¬é©— ---
        const TribeQuizZone = () => {
          const [phase, setPhase] = useState('select'); 
          const [selectedCards, setSelectedCards] = useState([]); 
          const [currentCardIdx, setCurrentCardIdx] = useState(0); 
          const [isAnswered, setIsAnswered] = useState(false);
          const [isCorrect, setIsCorrect] = useState(false);
          const [score, setScore] = useState(0);
          
          const TARGET_COUNT = 2;

          const cardData = [
            { id: 1, title: "åŸä½æ°‘æ—", q: "å°ç£åŸä½æ°‘æ—ç›®å‰å®˜æ–¹èªå®šå…±æœ‰å¹¾æ—ï¼Ÿ", options: ["9æ—", "14æ—", "16æ—"], ans: 2 },
            { id: 2, title: "ç¥­å…¸çš„æ„ç¾©", q: "åŸä½æ°‘èˆ‰è¾¦ç¥­å…¸çš„ä¸»è¦æ„ç¾©æ˜¯ä»€éº¼ï¼Ÿ", options: ["å–®ç´”èšé¤", "è¡¨é”å°å¤©åœ°é¬¼ç¥çš„å´‡æ•¬", "é‹å‹•ç«¶æŠ€æ¯”è³½"], ans: 1 },
            { id: 3, title: "é˜¿ç¾æ—", q: "é˜¿ç¾æ—æœ€ç››å¤§çš„ç¥­å…¸ã€Œè±å¹´ç¥­ã€é€šå¸¸åœ¨ä»€éº¼æ™‚å€™èˆ‰è¾¦ï¼Ÿ", options: ["æ˜¥ç¯€æœŸé–“", "7æœˆä¸­æ—¬è‡³9æœˆåˆ", "12æœˆå¯’å†¬"], ans: 1 },
            { id: 4, title: "æ’ç£æ—", q: "æ’ç£æ—çš„ã€ŒMasalutã€ç¥­å…¸ä¸­ï¼Œã€ŒSalutã€é€™å€‹å­—ä»£è¡¨ä»€éº¼æ„æ€ï¼Ÿ", options: ["è·¨è¶Š/é‚å‘æ–°å¹´", "è±æ”¶", "æ‰“çµ"], ans: 0 },
            { id: 5, title: "æ³°é›…æ—", q: "æ³°é›…æ—æœ€é‡è¦çš„ä¿¡ä»°ä¸­å¿ƒæ˜¯ä»€éº¼ï¼Ÿ", options: ["å¤ªé™½ç¥", "ç¥–éˆ (Utux)", "ç™¾æ­¥è›‡"], ans: 1 },
            { id: 6, title: "å¸ƒè¾²æ—", q: "å¸ƒè¾²æ—çš„ã€Œå°„è€³ç¥­ã€é™¤äº†ç¥­ç¥€ï¼Œé‚„æœ‰ä»€éº¼é‡è¦åŠŸèƒ½ï¼Ÿ", options: ["è¨“ç·´å°å­©ç‹©çµèˆ‡æˆé•·", "å°‹æ‰¾çµå©šå°è±¡", "ç¥ˆæ±‚ä¸‹é›¨"], ans: 0 },
            { id: 7, title: "å¤ªé­¯é–£æ—", q: "å¤ªé­¯é–£æ—æ“…é•·çš„å·¥è—é™¤äº†è—¤ç·¨ï¼Œé‚„æœ‰ä»€éº¼ï¼Ÿ", options: ["é™¶å£ºè£½ä½œ", "å½©è™¹èˆ¬çš„ç¹”å¸ƒ", "é€ èˆ¹"], ans: 1 },
            { id: 8, title: "å‘å—æ—", q: "å‘å—æ—ç››å¤§çš„ã€Œå¹´ç¥­ã€ä¸­ï¼ŒåŒ…å«äº†å“ªå…©å€‹é‡è¦æ´»å‹•ï¼Ÿ", options: ["çŒ´ç¥­èˆ‡å¤§çµç¥­", "é£›é­šç¥­èˆ‡æµ·ç¥­", "æˆ°ç¥­èˆ‡å°ç±³ç¥­"], ans: 0 },
            { id: 9, title: "é­¯å‡±æ—", q: "é­¯å‡±æ—åœ¨å©šç¦®æˆ–ç¥­å…¸ä¸­ï¼Œå¸¸æœƒèˆ‰è¾¦ä»€éº¼æµªæ¼«çš„æ´»å‹•ï¼Ÿ", options: ["ç›ªé¦éŸ†", "è³½è·‘", "å°„ç®­"], ans: 0 },
            { id: 10, title: "è³½å¾·å…‹æ—", q: "è³½å¾·å…‹æ—é™¤äº†å¥³å­ç¹”å¸ƒå¤–ï¼Œç”·å­æ“…é•·ä»€éº¼å·¥è—ï¼Ÿ", options: ["ç·¨ç±ƒåŠç±å¸½", "è£½ä½œç‰ç’ƒç ", "é›•åˆ»çŸ³æ¿"], ans: 0 },
            { id: 11, title: "é„’æ—", q: "é„’æ—çš„ã€Œå‡±æ—‹ç¥­ (Mayasvi)ã€ä¸»è¦æ˜¯ç¥­æ‹œå“ªä½ç¥ç¥‡ï¼Ÿ", options: ["æµ·ç¥", "å¤©ç¥èˆ‡æˆ°ç¥", "è¾²ç¥"], ans: 1 },
            { id: 12, title: "è³½å¤æ—", q: "è³½å¤æ—çš„ã€ŒçŸ®éˆç¥­ (Pasta'ay)ã€æ˜¯ç‚ºäº†ç´€å¿µèª°ï¼Ÿ", options: ["é”éš˜ (çŸ®äºº)", "ç¥–å…ˆ", "å·¨äºº"], ans: 0 },
            { id: 13, title: "é›…ç¾æ—(é”æ‚Ÿæ—)", q: "é›…ç¾æ—(é”æ‚Ÿæ—)æœ€é‡è¦çš„ç”Ÿæ…‹æ–‡åŒ–èˆ‡ä»€éº¼æœ‰é—œï¼Ÿ", options: ["å±±è±¬", "é£›é­š", "ç™¾åˆèŠ±"], ans: 1 },
            { id: 14, title: "å™¶ç‘ªè˜­æ—", q: "å™¶ç‘ªè˜­æ—ä¿æœ‰å“ªé …éå¸¸æœ‰ç‰¹è‰²çš„å·¥è—æŠ€è¡“ï¼Ÿ", options: ["ç·¨ç¹”é¦™è•‰çµ²", "è£½ä½œé™¶å£º", "çš®é›•"], ans: 0 },
            { id: 15, title: "æ’’å¥‡èŠé›…æ—", q: "æ’’å¥‡èŠé›…æ—çš„ã€Œç«ç¥ç¥­ (Palamal)ã€æ˜¯ç‚ºäº†ç´€å¿µä»€éº¼ï¼Ÿ", options: ["æ—ç¾¤é‡ç”Ÿèˆ‡ç¥–å…ˆ", "è±æ”¶", "æˆå¹´ç¦®"], ans: 0 },
            { id: 16, title: "é‚µæ—", q: "é‚µæ—å®¶å®¶æˆ¶æˆ¶ä¾›å¥‰ä»€éº¼ä¾†è±¡å¾µç¥–éˆï¼Ÿ", options: ["ç¥–éˆç±ƒ (Ulalaluan)", "é™¶å£º", "ç™¾æ­¥è›‡ç´‹"], ans: 0 },
            { id: 17, title: "æ‹‰é˜¿é­¯å“‡æ—", q: "æ‹‰é˜¿é­¯å“‡æ—çš„ã€Œè–è²ç¥­ã€ç¥­ç¥€çš„å°è±¡æ˜¯ï¼Ÿ", options: ["å¤ªé™½ç¥", "12ä½è²ç¥", "å±±ç¥"], ans: 1 },
            { id: 18, title: "å¡é‚£å¡é‚£å¯Œæ—", q: "å¡é‚£å¡é‚£å¯Œæ—çš„é‡è¦ç¥­å„€ã€Œç±³è²¢ç¥­ã€ä¸»è¦æ„Ÿè¬ä»€éº¼ï¼Ÿ", options: ["å°ç±³è±æ”¶", "çµç‰©è±æ”¶", "æˆ°é¬¥å‹åˆ©"], ans: 0 },
            { id: 19, title: "æ­£åä¹‹è·¯", q: "å“ªå…©å€‹æ—ç¾¤åœ¨ 2014 å¹´çµ‚æ–¼æ­£åæˆåŠŸï¼Ÿ", options: ["é‚µæ—èˆ‡å™¶ç‘ªè˜­æ—", "æ‹‰é˜¿é­¯å“‡æ—èˆ‡å¡é‚£å¡é‚£å¯Œæ—", "è³½å¾·å…‹æ—èˆ‡å¤ªé­¯é–£æ—"], ans: 1 },
            { id: 20, title: "æ¢ç´¢å°ç£ä¹‹ç¾", q: "å¡ç‰‡ä¸­æåˆ°æ¢ç´¢å°ç£åŸæ°‘æ–‡åŒ–æœ€å¥½çš„æ–¹å¼æ˜¯ï¼Ÿ", options: ["åœ¨å®¶çœ‹é›»è¦–", "èµ°é€²éƒ¨è½é«”é©—ç¾æ™¯èˆ‡ç¾é£Ÿ", "åªçœ‹æ›¸æœ¬"], ans: 1 },
          ];

          const handleToggleCard = (card) => {
            if (selectedCards.find(c => c.id === card.id)) {
              setSelectedCards(prev => prev.filter(c => c.id !== card.id));
            } else {
              if (selectedCards.length < TARGET_COUNT) {
                setSelectedCards(prev => [...prev, card].sort((a, b) => a.id - b.id));
              }
            }
          };

          const handleStartQuiz = () => {
            if (selectedCards.length === TARGET_COUNT) {
              setPhase('quiz');
              setCurrentCardIdx(0);
              setScore(0);
              setIsAnswered(false);
              setIsCorrect(false);
            }
          };

          const handleAnswer = (idx) => {
            if (isAnswered) return;
            const currentCard = selectedCards[currentCardIdx];
            const correct = idx === currentCard.ans;
            setIsAnswered(true);
            setIsCorrect(correct);
            if(correct) setScore(s => s + 1);
          };

          const handleNextQuestion = () => {
            if (currentCardIdx < TARGET_COUNT - 1) {
              setCurrentCardIdx(prev => prev + 1);
              setIsAnswered(false);
              setIsCorrect(false);
            } else {
              setPhase('summary');
            }
          };

          const resetAll = () => {
            setSelectedCards([]);
            setPhase('select');
          };

          return (
            <div className="flex flex-col items-center justify-center min-h-full bg-amber-50 p-4">
              <div className="md:absolute md:top-4 md:left-4 mb-4 md:mb-0 bg-amber-600 text-white px-4 py-2 rounded-full font-bold flex items-center gap-2 z-10 shadow">
                <CreditCard size={20} /> Zone Bï¼šå¡ç‰‡è§£å¯†æ¸¬é©—
              </div>

              {phase === 'select' && (
                <div className="w-full max-w-5xl text-center animate-in zoom-in h-full flex flex-col flex-1 pb-20 md:pb-0">
                  <div className="mb-4">
                    <h2 className="text-2xl md:text-3xl font-black text-amber-900 mb-2">è«‹é¸æ“‡å¡ç‰‡ä¸Šçš„ {TARGET_COUNT} å€‹è™Ÿç¢¼</h2>
                    <p className="text-amber-600 font-bold">
                      ç›®å‰å·²é¸æ“‡ï¼š
                      <span className="text-2xl mx-2 font-black text-stone-800">
                        {selectedCards.length} / {TARGET_COUNT}
                      </span>
                    </p>
                  </div>
                  
                  <div className="flex-1 overflow-y-auto px-2 no-scrollbar min-h-0">
                    <div className="grid grid-cols-4 md:grid-cols-5 gap-3">
                      {cardData.map((card) => {
                        const isSelected = selectedCards.find(c => c.id === card.id);
                        return (
                          <button
                            key={card.id}
                            onClick={() => handleToggleCard(card)}
                            className={`aspect-square rounded-2xl shadow-md border-b-4 flex flex-col items-center justify-center group transition-all duration-200 ${
                              isSelected 
                                ? 'bg-amber-500 border-amber-700 -translate-y-1' 
                                : 'bg-white border-amber-200 hover:border-amber-400'
                            }`}
                          >
                            <span className={`text-3xl font-black transition-colors ${isSelected ? 'text-white' : 'text-stone-300 group-hover:text-amber-500'}`}>
                              {card.id.toString().padStart(2, '0')}
                            </span>
                            <span className={`text-xs font-bold mt-1 px-1 truncate w-full ${isSelected ? 'text-white' : 'text-stone-500'}`}>
                              {card.title}
                            </span>
                            {isSelected && <CheckCircle2 className="absolute top-2 right-2 text-white" size={20} />}
                          </button>
                        );
                      })}
                    </div>
                  </div>

                  <div className="w-full flex justify-center mt-4 pb-4 md:pb-0 sticky bottom-0 bg-amber-50/95 p-4 backdrop-blur-sm">
                    <button 
                      onClick={handleStartQuiz}
                      disabled={selectedCards.length !== TARGET_COUNT}
                      className={`w-full md:w-auto px-12 py-4 rounded-full font-black text-2xl shadow-xl flex items-center justify-center gap-3 transition-all transform ${
                        selectedCards.length === TARGET_COUNT 
                          ? 'bg-stone-800 text-white hover:bg-stone-700 hover:scale-105 active:scale-95 cursor-pointer' 
                          : 'bg-stone-300 text-stone-500 cursor-not-allowed'
                      }`}
                    >
                      {selectedCards.length === TARGET_COUNT ? "é–‹å§‹è§£å¯†" : `è«‹å†é¸ ${TARGET_COUNT - selectedCards.length} å€‹`} <ArrowRight />
                    </button>
                  </div>
                </div>
              )}

              {phase === 'quiz' && (
                <div className="w-full max-w-2xl animate-in slide-in-from-right flex flex-col h-full md:block overflow-y-auto pb-4">
                  <div className="flex justify-between items-center mb-6 px-2">
                    <span className="text-amber-800 font-bold uppercase tracking-widest">
                      ä»»å‹™é€²åº¦ {currentCardIdx + 1} / {TARGET_COUNT}
                    </span>
                    <div className="flex gap-2">
                      {selectedCards.map((c, i) => (
                        <div key={i} className={`w-3 h-3 rounded-full ${i === currentCardIdx ? 'bg-amber-600' : i < currentCardIdx ? 'bg-green-500' : 'bg-gray-300'}`} />
                      ))}
                    </div>
                  </div>

                  <div className="bg-white p-8 rounded-3xl shadow-xl border-b-8 border-amber-200 mb-6 text-center">
                    <div className="inline-block bg-amber-100 text-amber-800 px-4 py-1 rounded-full font-bold text-sm mb-4">
                      å¡ç‰‡ç·¨è™Ÿ #{selectedCards[currentCardIdx].id.toString().padStart(2, '0')}
                    </div>
                    <h3 className="text-2xl md:text-3xl font-black text-stone-800 leading-snug">
                      {selectedCards[currentCardIdx].q}
                    </h3>
                  </div>

                  <div className="grid gap-4 mb-20 md:mb-0">
                    {selectedCards[currentCardIdx].options.map((opt, i) => (
                      <button
                        key={i}
                        onClick={() => handleAnswer(i)}
                        disabled={isAnswered}
                        className={`p-5 rounded-xl font-bold text-xl text-left transition-all border-2 flex items-center justify-between ${
                          isAnswered 
                            ? i === selectedCards[currentCardIdx].ans 
                              ? 'bg-green-500 text-white border-green-600 shadow-md' 
                              : 'bg-stone-100 text-stone-400 border-transparent'
                            : 'bg-white text-stone-700 border-stone-200 hover:border-amber-400 hover:shadow-md hover:scale-[1.02]'
                        }`}
                      >
                        <span>{opt}</span>
                        {isAnswered && i === selectedCards[currentCardIdx].ans && <Check size={28} className="animate-bounce" />}
                      </button>
                    ))}
                  </div>

                  {isAnswered && (
                    <div className="fixed bottom-0 left-0 w-full md:relative md:mt-8 bg-white/95 md:bg-transparent p-4 md:p-0 border-t md:border-t-0 border-stone-200 backdrop-blur-md md:backdrop-blur-none animate-in slide-in-from-bottom z-50 flex flex-col items-center text-center">
                      <div className={`text-2xl md:text-3xl font-black mb-2 ${isCorrect ? 'text-green-600' : 'text-red-500'}`}>
                        {isCorrect ? "ç­”å°äº†ï¼" : "å†çœ‹ä¸€æ¬¡å¡ç‰‡å–”ï¼"}
                      </div>
                      <button 
                        onClick={handleNextQuestion}
                        className="w-full md:w-auto px-10 py-3 bg-stone-800 text-white rounded-full font-bold text-lg hover:bg-stone-700 shadow-lg flex items-center justify-center gap-2"
                      >
                        {currentCardIdx < TARGET_COUNT - 1 ? "ä¸‹ä¸€é¡Œ" : "æŸ¥çœ‹çµæœ"} <ArrowRight size={18}/>
                      </button>
                    </div>
                  )}
                </div>
              )}

              {phase === 'summary' && (
                <div className="w-full max-w-lg text-center animate-in zoom-in bg-white p-10 rounded-3xl shadow-2xl border-4 border-amber-200 my-auto">
                  <div className="text-8xl mb-6">{score === TARGET_COUNT ? 'ğŸ†' : 'ğŸ’ª'}</div>
                  <h2 className="text-4xl font-black text-amber-900 mb-4">æŒ‘æˆ°å®Œæˆï¼</h2>
                  <p className="text-2xl text-stone-600 mb-8">
                    ä½ åœ¨ {TARGET_COUNT} é¡Œä¸­ç­”å°äº† <span className="text-amber-600 font-bold text-4xl mx-2">{score}</span> é¡Œ
                  </p>
                  
                  <div className="flex gap-4 justify-center">
                    {score === TARGET_COUNT ? (
                      <div className="bg-green-100 px-6 py-4 rounded-xl text-green-800 font-bold w-full">
                        å¤ªæ£’äº†ï¼<br/>ä½ æ˜¯éƒ¨è½çŸ¥è­˜ç‹ï¼
                      </div>
                    ) : (
                      <div className="bg-stone-100 px-6 py-4 rounded-xl text-stone-600 font-bold w-full">
                        åˆ¥ç°å¿ƒï¼<br/>å†ä»”ç´°è®€ä¸€ä¸‹å¡ç‰‡å–”ï¼
                      </div>
                    )}
                  </div>

                  <button onClick={resetAll} className="mt-8 text-stone-400 underline hover:text-stone-600 flex items-center justify-center gap-2 mx-auto">
                    <RefreshCw size={16}/> æ¥å¾…ä¸‹ä¸€ä½
                  </button>
                </div>
              )}
            </div>
          );
        };

        // --- Zone C: åå­—çš„å¥§ç§˜ ---
        const NamingZone = () => {
          const [phase, setPhase] = useState('teach');
          const [slideIdx, setSlideIdx] = useState(0);
          
          const slides = [
            { title: "åå­—çš„æ„ç¾©ï¼šå¤§è‡ªç„¶çš„é€£çµ", icon: "ğŸ”ï¸", content: "åŸä½æ°‘çš„åå­—å¸¸å¸¸è·Ÿè‡ªç„¶æœ‰é—œï¼\nä¾‹å¦‚ï¼šCidal (å¤ªé™½)ã€Panay (ç¨»ç©—)ã€Lokay (é¹¿)ã€‚\næˆ‘å€‘ç›¸ä¿¡åå­—æœƒçµ¦å­©å­å¤§è‡ªç„¶çš„åŠ›é‡ã€‚", color: "bg-teal-600" },
            { title: "è¦ªå­é€£ååˆ¶", icon: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦", content: "æœ‰äº›æ—ç¾¤ï¼ˆå¦‚é˜¿ç¾æ—ã€æ³°é›…æ—ï¼‰çš„åå­—å¾Œé¢æœƒåŠ ä¸Šçˆ¸çˆ¸æˆ–åª½åª½çš„åå­—ã€‚\nä¾‹å¦‚ï¼šKolas (å…’å­) + Mayaw (çˆ¸çˆ¸) = Kolas Mayawã€‚\né€™ä»£è¡¨æˆ‘å€‘å¾ˆé‡è¦–å®¶æ—çš„è¡€è„ˆèˆ‡å‚³æ‰¿ã€‚", color: "bg-blue-500" },
            { title: "ç”Ÿå‘½è¨˜æ†¶èˆ‡éšç´š", icon: "ğŸ‘¶", content: "æœ‰çš„åå­—æ˜¯ç´€éŒ„å‡ºç”Ÿæ™‚ç™¼ç”Ÿçš„äº‹ï¼ˆå¦‚ä¸‹é›¨ã€é¢±é¢¨ï¼‰ã€‚\nåœ¨æ’ç£æ—æˆ–é­¯å‡±æ—ï¼Œæœ‰äº›åå­—åªæœ‰è²´æ—æˆ–é ­ç›®æ‰èƒ½ä½¿ç”¨ï¼Œä»£è¡¨è‘—ç‰¹æ®Šçš„èº«ä»½èˆ‡æ¦®è€€ã€‚", color: "bg-purple-500" }
          ];

          const fullQuestionBank = [
             { q: "åŸä½æ°‘æ—çš„åå­—å’Œæ¼¢äººåå­—æœ‰ä»€éº¼ä¸åŒï¼Ÿ", opts: ["åŸä½æ°‘æ—çš„åå­—é€šå¸¸æœ‰æ—èªç‰¹è‰²", "å®Œå…¨ä¸€æ¨£", "éƒ½æ˜¯ä¸‰å€‹å­—"], ans: 0 },
            { q: "åŸä½æ°‘æ—çš„å‚³çµ±åå­—æœƒå’Œä»€éº¼æœ‰é—œï¼Ÿ", opts: ["è‡ªç„¶ï¼ˆå±±ã€æ²³æµï¼‰", "å¤©æ°£ï¼ˆä¸‹é›¨ï¼‰", "ä»¥ä¸Šçš†æ˜¯"], ans: 2 },
            { q: "æœ‰äº›åŸä½æ°‘æ—çš„åå­—ï¼Œå¾Œé¢æœƒåŠ ä¸Šèª°çš„åå­—ï¼Ÿ", opts: ["çˆ¸çˆ¸æˆ–åª½åª½", "é„°å±…", "è€å¸«"], ans: 0 },
            { q: "å¦‚æœåå­—å« Panay (ç¨»ç©—)ï¼Œå¯èƒ½ä»£è¡¨é•·è¼©å¸Œæœ›ä»–ï¼Ÿ", opts: ["å¾ˆæ„›åƒé£¯", "åƒç¨»ç©—ä¸€æ¨£è¬™è™›", "å»ç¨®ç”°"], ans: 1 },
            { q: "åå­—è£¡æœ‰ Cidal (å¤ªé™½)ï¼Œé€šå¸¸ä»£è¡¨ä»€éº¼ï¼Ÿ", opts: ["åƒå¤ªé™½ä¸€æ¨£æº«æš–", "æ€•æ›¬é»‘", "å–œæ­¡å¤å¤©"], ans: 0 },
            { q: "ç‚ºä»€éº¼æœ‰äº›åŸä½æ°‘æœ‰å…©å€‹åå­—ï¼Ÿ", opts: ["æ–¹ä¾¿ä¸åŒå ´åˆä½¿ç”¨", "æƒ³è¦å…©å€‹èº«ä»½", "åå­—å¤ªé•·"], ans: 0 },
            { q: "æ³°é›…æ—çš„å‘½åå‚³çµ±ï¼Œåå­—ä»£è¡¨ä»€éº¼ï¼Ÿ", opts: ["å®¶æ—è¡€çµ±èˆ‡å‚³æ‰¿", "é‹å‹•æ¯”è³½", "æ–°ç™¼æ˜"], ans: 0 },
            { q: "åŸä½æ°‘æ—çš„åå­—ç‚ºä»€éº¼é€™éº¼é‡è¦ï¼Ÿ", opts: ["ä»£è¡¨æ–‡åŒ–èˆ‡å‚³æ‰¿", "è€ƒè©¦æ¯”è¼ƒå¥½å¯«", "éš¨ä¾¿å–çš„"], ans: 0 },
            { q: "åŸä½æ°‘æ—å‚³çµ±ä¸Šæ€éº¼ç¨±å‘¼å°æ–¹ï¼Ÿ", opts: ["ç›´æ¥å«åå­—", "å–‚ï¼", "åªå«ç¶½è™Ÿ"], ans: 0 },
            { q: "ä»¥å‰æœ‰äº›å­©å­é•·å¤§å¾Œï¼Œæœƒç¹¼æ‰¿èª°çš„åå­—ï¼Ÿ", opts: ["ç¥–çˆ¶æ¯æˆ–çˆ¶æ¯", "è€å¸«", "å¶åƒ"], ans: 0 }
          ];

          const [quizQuestions, setQuizQuestions] = useState([]);
          const [currentQ, setCurrentQ] = useState(0);
          const [score, setScore] = useState(0);
          const [showFeedback, setShowFeedback] = useState(false);
          const [selectedOpt, setSelectedOpt] = useState(null);

          const nextSlide = () => {
            if (slideIdx < slides.length - 1) {
              setSlideIdx(prev => prev + 1);
            } else {
              const shuffled = [...fullQuestionBank].sort(() => 0.5 - Math.random());
              setQuizQuestions(shuffled.slice(0, 3));
              setPhase('quiz');
              setCurrentQ(0);
              setScore(0);
            }
          };

          const prevSlide = () => {
            if (slideIdx > 0) setSlideIdx(prev => prev - 1);
          };

          const handleAnswer = (optIndex) => {
            if (showFeedback) return;
            setSelectedOpt(optIndex);
            setShowFeedback(true);
            if (optIndex === quizQuestions[currentQ].ans) {
              setScore(s => s + 1);
            }
            setTimeout(() => {
              if (currentQ < 2) {
                setCurrentQ(q => q + 1);
                setShowFeedback(false);
                setSelectedOpt(null);
              } else {
                setPhase('result');
              }
            }, 1500);
          };

          const restart = () => {
            setPhase('teach');
            setSlideIdx(0);
          };

          return (
            <div className="flex flex-col items-center justify-center min-h-full bg-violet-50 p-4">
              <div className="md:absolute md:top-4 md:left-4 mb-4 md:mb-0 bg-violet-600 text-white px-4 py-2 rounded-full font-bold flex items-center gap-2 z-10 shadow">
                <UserCheck size={20} /> Zone Cï¼šåå­—çš„å¥§ç§˜
              </div>

              {phase === 'teach' && (
                <div className="w-full max-w-2xl text-center animate-in zoom-in flex flex-col flex-1 py-4 md:py-16">
                  <div className="bg-white p-8 rounded-3xl shadow-2xl border-4 border-violet-100 flex flex-col justify-center items-center flex-1 min-h-[420px]">
                    <div className="flex gap-2 mb-6">
                      {slides.map((_, i) => (
                        <div key={i} className={`w-3 h-3 rounded-full ${i === slideIdx ? 'bg-violet-600' : 'bg-gray-200'}`} />
                      ))}
                    </div>
                    <div className="text-8xl mb-6">{slides[slideIdx].icon}</div>
                    <h2 className={`text-2xl md:text-3xl font-black mb-6 ${slides[slideIdx].color} text-white px-6 py-2 rounded-full shadow-md`}>
                      {slides[slideIdx].title}
                    </h2>
                    <div className="text-lg md:text-xl text-gray-600 font-bold leading-relaxed whitespace-pre-line text-left md:text-center w-full">
                      {slides[slideIdx].content}
                    </div>
                  </div>
                  
                  <div className="flex justify-between mt-8 gap-4 w-full sticky bottom-0 bg-violet-50 pb-4 md:relative md:bg-transparent md:pb-0">
                    <button onClick={prevSlide} disabled={slideIdx === 0} className={`flex-1 px-6 py-3 rounded-xl font-bold flex items-center justify-center gap-2 ${slideIdx === 0 ? 'text-gray-300' : 'bg-white text-violet-600 shadow-md hover:bg-violet-50'}`}>
                      <ChevronLeft /> ä¸Šä¸€é 
                    </button>
                    <button onClick={nextSlide} className="flex-[2] px-6 py-3 bg-violet-600 text-white rounded-xl font-black text-xl shadow-lg hover:bg-violet-700 flex items-center justify-center gap-2">
                      {slideIdx === slides.length - 1 ? "é–‹å§‹æŒ‘æˆ°ï¼" : "ä¸‹ä¸€é "} <ChevronRight />
                    </button>
                  </div>
                </div>
              )}

              {phase === 'quiz' && quizQuestions.length > 0 && (
                <div className="w-full max-w-2xl animate-in slide-in-from-right h-full overflow-y-auto pt-4 pb-20">
                  <div className="flex justify-between items-center mb-6 px-2">
                    <span className="text-violet-400 font-bold uppercase tracking-widest">Question {currentQ + 1} / 3</span>
                    <span className="bg-violet-200 text-violet-800 px-3 py-1 rounded-full font-bold text-sm">Score: {score}</span>
                  </div>
                  <div className="bg-white p-8 rounded-3xl shadow-xl border-b-8 border-violet-200 mb-6 min-h-[180px] flex items-center justify-center">
                    <h3 className="text-2xl font-black text-gray-800 leading-snug text-center">
                      {quizQuestions[currentQ].q}
                    </h3>
                  </div>
                  <div className="grid gap-4">
                    {quizQuestions[currentQ].opts.map((opt, i) => (
                      <button
                        key={i}
                        onClick={() => handleAnswer(i)}
                        disabled={showFeedback}
                        className={`p-4 rounded-xl font-bold text-lg text-left transition-all border-2 ${
                          showFeedback 
                            ? i === quizQuestions[currentQ].ans 
                              ? 'bg-green-500 text-white border-green-600 scale-105' 
                              : i === selectedOpt 
                                ? 'bg-red-500 text-white border-red-600'
                                : 'bg-gray-100 text-gray-400 border-transparent'
                            : 'bg-white text-gray-700 border-gray-200 hover:border-violet-400 hover:shadow-md'
                        }`}
                      >
                        <div className="flex items-center gap-3">
                          <div className="w-8 h-8 rounded-full border-2 border-current flex items-center justify-center text-sm opacity-50">
                            {String.fromCharCode(65 + i)}
                          </div>
                          {opt}
                        </div>
                      </button>
                    ))}
                  </div>
                </div>
              )}

              {phase === 'result' && (
                <div className="animate-in zoom-in bg-white p-10 rounded-3xl shadow-2xl border-4 border-violet-100 text-center max-w-md w-full my-auto">
                  <div className="text-8xl mb-6">{score === 3 ? 'ğŸ‰' : 'ğŸ“š'}</div>
                  <h2 className="text-4xl font-black text-violet-900 mb-4">æŒ‘æˆ°çµæŸï¼</h2>
                  <p className="text-2xl text-gray-600 mb-8">
                    ä½ ç­”å°äº† <span className="text-violet-600 font-bold text-4xl mx-2">{score}</span> é¡Œ
                  </p>
                  <button onClick={restart} className="text-gray-400 underline hover:text-violet-600 flex items-center justify-center gap-2 mx-auto">
                    <RefreshCw size={16}/> é‡æ–°é–‹å§‹
                  </button>
                </div>
              )}
            </div>
          );
        };

        // --- Zone D: åŸ‹è—çš„ç›’å­ (é»æ“Šå³æŠ½çç‰ˆ - åŒ…å«æ¨¡æ“¬è³‡æ–™) ---
        const LotteryZone = () => {
          const [state, setState] = useState('idle');
          const [prize, setPrize] = useState(null);
          const [errorMsg, setErrorMsg] = useState("");

          // ä½¿ç”¨è€…æä¾›çš„çå“æ¸…å–®èˆ‡æ•¸é‡
          const demoPrizes = [
            { name: "è¡›ç”Ÿç´™", count: 30, type: "small" },
            { name: "ä¸‰åˆä¸€å……é›»ç·š", count: 15, type: "big" },
            { name: "æ»‘é¼ å¢Š", count: 10, type: "big" },
            { name: "ç­†è¨˜æœ¬", count: 16, type: "small" },
            { name: "å¸†å¸ƒè¢‹", count: 12, type: "big" },
            { name: "æ¯å¢Š", count: 20, type: "small" },
            { name: "æ‰‡å­", count: 54, type: "small" },
            { name: "è³‡æ–™å¤¾", count: 44, type: "small" },
            { name: "è¯ååŒ…", count: 25, type: "big" },
            { name: "é¦¬å…‹æ¯", count: 5, type: "big" },
          ];

          const drawPrize = async () => {
            if (state === 'drawing') return;
            setState('drawing');
            setErrorMsg("");
            try {
              if (GAS_API_URL && GAS_API_URL !== "https://script.google.com/macros/s/AKfycbzCJVchaq7JMq1SJvNNNHzj1ojJDgmcffgoscCnrN5lx32_RvAzy1NSQT-VJWLush4/exec") {
                // å¦‚æœæœ‰è¨­å®šçœŸå¯¦å¾Œå°ç¶²å€ï¼Œå˜—è©¦é€£ç·š
                const timestamp = new Date().getTime();
                const response = await fetch(`${GAS_API_URL}?action=draw&t=${timestamp}`, {
                  method: "GET",
                  mode: 'cors',
                  credentials: 'omit',
                  redirect: 'follow',
                  headers: { "Content-Type": "text/plain;charset=utf-8" },
                });
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                if (data.error === "No prizes left!") {
                   setPrize(data.prize || { name: "éŠ˜è¬æƒ é¡§", type: "none" });
                   setState('result');
                   return; 
                }
                if (data.error) throw new Error(data.error);
                setPrize(data.prize);
              } else {
                // æ¨¡æ“¬æŠ½çæ¨¡å¼ (ä¾ç…§æ•¸é‡åŠ æ¬Š)
                await new Promise(r => setTimeout(r, 1500));
                
                // å»ºç«‹åŠ æ¬Šæ± 
                let weightedPool = [];
                demoPrizes.forEach(p => {
                    for(let i=0; i<p.count; i++) weightedPool.push(p);
                });
                
                const randomPrize = weightedPool[Math.floor(Math.random() * weightedPool.length)];
                setPrize(randomPrize);
              }
              setState('result');
            } catch (err) {
              console.error(err);
              setErrorMsg(err.message);
              // é€£ç·šå¤±æ•—æ™‚åˆ‡æ›åˆ°å‚™ç”¨æŠ½ç
              const randomPrize = demoPrizes[Math.floor(Math.random() * demoPrizes.length)];
              setPrize(randomPrize);
              setState('result');
            }
          };

          const reset = () => { 
            setState('idle'); 
            setPrize(null);
          };

          return (
            <div className="flex flex-col items-center justify-center h-full bg-indigo-900 p-4 relative overflow-hidden">
              <div className="absolute top-4 left-4 bg-indigo-500 text-white px-4 py-2 rounded-full font-bold flex items-center gap-2 border border-indigo-400 z-10">
                <Gift size={20} /> Zone Dï¼šåŸ‹è—çš„ç›’å­
              </div>
              <div className="z-10 w-full max-w-lg text-center">
                {state === 'idle' && (
                  <div className="animate-in zoom-in">
                    <div className="text-6xl mb-8 animate-bounce">ğŸ“¦</div>
                    <h2 className="text-3xl font-black text-white mb-4">æˆ‘å€‘æ‰¾åˆ°ç›’å­äº†ï¼</h2>
                    <button onClick={drawPrize} className="px-12 py-6 bg-yellow-500 text-yellow-900 text-3xl font-black rounded-full shadow-lg hover:scale-105 transition-transform active:scale-95">æ‰“é–‹ç›’å­</button>
                    {errorMsg && <div className="mt-4 text-red-300 text-sm">é€£ç·šç•°å¸¸ï¼Œå·²åˆ‡æ›è‡³å‚™ç”¨æ¨¡å¼</div>}
                  </div>
                )}
                {state === 'drawing' && <div className="text-white text-2xl font-bold animate-pulse">è§£é–ä¸­...</div>}
                {state === 'result' && prize && (
                  <div className="bg-white p-10 rounded-3xl shadow-2xl animate-in zoom-in transform rotate-1">
                     <div className="text-8xl mb-4">{prize.type === 'big' ? 'ğŸ†' : 'ğŸ¬'}</div>
                     <h3 className="text-indigo-400 font-bold uppercase tracking-widest mb-2">ç²å¾—ä¿¡ç‰©</h3>
                     <h2 className="text-4xl font-black text-indigo-600 mb-4">{prize.name}</h2>
                     <button onClick={reset} className="text-gray-400 underline">å†è©¦ä¸€æ¬¡</button>
                  </div>
                )}
              </div>
            </div>
          );
        };

        // --- ä¸»æ¡†æ¶ ---
        function InteractiveApp() {
          const [activeZone, setActiveZone] = useState('A');

          return (
            <div className="flex w-full h-[100dvh] bg-stone-900 font-sans text-gray-800 overflow-hidden select-none">
              <div className="w-16 md:w-64 bg-stone-800 h-full flex flex-col shadow-2xl z-20 border-r border-stone-700">
                <div className="p-2 md:p-6 bg-stone-900 border-b border-stone-700 flex flex-col items-center md:items-start">
                  <h1 className="text-white font-black text-xl flex flex-col md:flex-row items-center gap-2">
                    <Map className="text-amber-500" />
                    <span className="hidden md:inline">2026ä¸–ç•Œæ¯èªæ—¥</span>
                  </h1>
                  <span className="hidden md:block text-sm text-amber-500 font-bold mt-1">makila kuman</span>
                </div>
                <div className="flex-1 py-4 space-y-2 overflow-y-auto no-scrollbar">
                  <NavBtn id="A" title="åŸä½æ°‘æ–‡åŒ–çŸ¥è­˜é€š" icon={BookOpen} active={activeZone === 'A'} onClick={() => setActiveZone('A')} color="text-amber-400" />
                  <NavBtn id="B" title="å¡ç‰‡è§£å¯†æ¸¬é©—" icon={Edit3} active={activeZone === 'B'} onClick={() => setActiveZone('B')} color="text-sky-400" />
                  <NavBtn id="C" title="åå­—çš„å¥§ç§˜" icon={UserCheck} active={activeZone === 'C'} onClick={() => setActiveZone('C')} color="text-violet-400" />
                  <div className="my-2 border-t border-stone-700 mx-2 md:mx-4"></div>
                  <NavBtn id="D" title="åŸ‹è—çš„ç›’å­" icon={Gift} active={activeZone === 'D'} onClick={() => setActiveZone('D')} color="text-indigo-400" />
                </div>
              </div>
              {/* åŠ å…¥ overflow-hidden ä¸¦è®“å­å…ƒç´ è™•ç†æ»¾å‹•ï¼Œæˆ–ç›´æ¥ overflow-y-auto */}
              <div className="flex-1 h-full relative bg-stone-100 overflow-y-auto no-scrollbar">
                {activeZone === 'A' && <TribeIntroZone />}
                {activeZone === 'B' && <TribeQuizZone />}
                {activeZone === 'C' && <NamingZone />}
                {activeZone === 'D' && <LotteryZone />}
              </div>
            </div>
          );
        }

        const NavBtn = ({ id, title, icon: Icon, active, onClick, color }) => (
          <button onClick={onClick} className={`w-full p-3 md:p-4 flex flex-col md:flex-row items-center gap-1 md:gap-4 transition-all relative group ${active ? 'bg-stone-700' : 'hover:bg-stone-700/50'}`}>
            <div className={`p-2 rounded-lg ${active ? 'bg-stone-900' : 'bg-stone-800 group-hover:bg-stone-900'}`}><Icon className={color} size={24} /></div>
            <div className={`text-center md:text-left text-xs md:text-base font-bold ${active ? 'text-white' : 'text-stone-400 hidden md:block'}`}>{title}</div>
            {active && <div className={`absolute left-0 top-0 bottom-0 w-1 ${color.replace('text', 'bg')}`} />}
          </button>
        );

        // æ¸²æŸ“åˆ°é é¢
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<InteractiveApp />);
    </script>
</body>
</html>
